googleapiclient.errors.HttpError: <HttpError 400 when requesting https://slides.googleapis.com/v1/presentations/1Rudg8tVuedtkd7GTb8PCWQOXPgwlTAzMcZt2Hv9VteQ:batchUpdate?alt=json returned "Invalid requests[0].createImage: Access to the provided image was forbidden.". Details: "Invalid requests[0].createImage: Access to the provided image was forbidden.">



    def publish_projection(self, fname, presentation_id, page_id, size, posx, posy):
        ############## dropbox if google doesnt work
        
        # with open(fname, 'rb') as f:
        #     self.dbx.files_upload(f.read(), '/'+fname, dropbox.files.WriteMode.overwrite)
        #     proj_url = self.dbx.files_get_temporary_link('/'+fname).link
        #     self.snippets.create_image(presentation_id, page_id, proj_url, size, size, posx, posy)
        
        ############## google
        
        # create folder images in google drive
        file_metadata = {"name": fname,}
        rs = self.drive.files().list(q=f"name='{fname}'").execute()
        media = MediaFileUpload(fname,resumable=True)        
        print(rs)
        if len(rs['files'])==0:
            file_metadata['parents']= [GOOGLE_FOLDER_ID]
            file = self.drive.files().create(body=file_metadata, media_body=media, fields='id').execute()        
        else:
            
            file = self.drive.files().update(fileId=rs['files'][0]['id'],body=file_metadata, media_body=media, fields='id').execute()        
        # take file id and generate the url of the image
        proj_url = 'https://drive.google.com/uc?export=download&id=' + file['id']
        print(proj_url)
        # print(IMAGE_URL)
        self.snippets.create_image(presentation_id, page_id, proj_url, size, size, posx, posy)